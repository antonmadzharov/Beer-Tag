{"ast":null,"code":"import _defineProperty from \"/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/src/components/CatalogList.js\";\nimport React, { Component } from \"react\";\nimport ReactTable from \"react-table\";\nimport \"react-table/react-table.css\";\nimport { SERVER_URL } from \"../constants.js\";\nimport { confirmAlert } from \"react-confirm-alert\";\nimport \"react-confirm-alert/src/react-confirm-alert.css\";\nimport { MDBBtn, MDBIcon, MDBFormInline } from \"mdbreact\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport NewPlayList from \"./NewPlaylist\";\n\nvar CatalogList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CatalogList, _Component);\n\n  function CatalogList(props) {\n    var _this;\n\n    _classCallCheck(this, CatalogList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CatalogList).call(this, props));\n    _this.fetchProducts =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var token;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.setState({\n                products: []\n              });\n\n              token = sessionStorage.getItem(\"jwt\");\n              _context.next = 4;\n              return fetch(SERVER_URL + \"api/products\", {\n                headers: {\n                  Authorization: token\n                }\n              }).then(function (response) {\n                return response.json();\n              }).then(function (responseData) {\n                _this.setState({\n                  products: responseData._embedded.products\n                });\n              }).catch(function (err) {\n                return console.error(err);\n              });\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.customFilter = function (filter, row) {\n      var id = filter.pivotId || filter.id;\n\n      if (row[id] !== null && typeof row[id] === \"string\") {\n        return row[id] !== undefined ? String(row[id].toLowerCase()).includes(filter.value.toLowerCase()) : true;\n      }\n    };\n\n    _this.confirmDelete = function (link) {\n      confirmAlert({\n        message: \"Are you sure to delete?\",\n        buttons: [{\n          label: \"Yes\",\n          onClick: function onClick() {\n            return _this.onDelClick(link);\n          }\n        }, {\n          label: \"No\"\n        }]\n      });\n    };\n\n    _this.onDelClick = function (link) {\n      var token = sessionStorage.getItem(\"jwt\");\n      fetch(link, {\n        method: \"DELETE\",\n        headers: {\n          Authorization: token\n        }\n      }).then(function (res) {\n        _this.setState({\n          open: true,\n          message: \"Deleted\"\n        });\n\n        _this.fetchProducts();\n      }).catch(function (err) {\n        _this.setState({\n          open: true,\n          message: \"Error when deleting\"\n        });\n\n        console.error(err);\n      });\n    };\n\n    _this.renderEditable = function (cellInfo) {\n      return React.createElement(\"div\", {\n        style: {\n          backgroundColor: \"#fafafa\"\n        },\n        contentEditable: true,\n        suppressContentEditableWarning: true,\n        onBlur: function onBlur(e) {\n          var data = _toConsumableArray(_this.state.products);\n\n          data[cellInfo.index][cellInfo.column.id] = e.target.innerHTML;\n\n          _this.setState({\n            products: data\n          });\n        },\n        dangerouslySetInnerHTML: {\n          __html: _this.state.products[cellInfo.index][cellInfo.column.id]\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      });\n    };\n\n    _this.handleClose = function (event, reason) {\n      _this.setState({\n        open: false\n      });\n    };\n\n    _this.handleChange = function (event) {\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.state = {\n      username: _this.props.username,\n      role: _this.props.role,\n      products: [],\n      open: false,\n      message: \"\",\n      duration: 0\n    };\n    return _this;\n  }\n\n  _createClass(CatalogList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchProducts();\n    } // Fetch all products\n\n  }, {\n    key: \"addProduct\",\n    // Add new product from child\n    value: function addProduct(product) {\n      var _this2 = this;\n\n      var token = sessionStorage.getItem(\"jwt\");\n      fetch(SERVER_URL + \"api/products\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: token\n        },\n        body: JSON.stringify(product)\n      }).then(function (res) {\n        return _this2.fetchProducts();\n      }).catch(function (err) {\n        return console.error(err);\n      });\n    } // Update Product\n\n  }, {\n    key: \"updateProduct\",\n    value: function updateProduct(product, link) {\n      var _this3 = this;\n\n      var token = sessionStorage.getItem(\"jwt\");\n      fetch(link, {\n        method: \"PUT\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: token\n        },\n        body: JSON.stringify(product)\n      }).then(function (res) {\n        return _this3.setState({\n          open: true,\n          message: \"Changes saved\"\n        });\n      }).catch(function (err) {\n        return _this3.setState({\n          open: true,\n          message: \"Error when saving\"\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var columns = [{\n        Header: \"Name\",\n        accessor: \"name\",\n        Cell: this.renderEditable\n      }, {\n        Header: \"Price\",\n        filterable: false,\n        accessor: \"price\",\n        width: 78,\n        Cell: this.renderEditable\n      }, {\n        Header: \"Description\",\n        accessor: \"description\",\n        Cell: this.renderEditable\n      }, {\n        Header: \"Created by\",\n        accessor: \"username\",\n        width: 110\n      }, {\n        Header: \"Image URL\",\n        accessor: \"image\",\n        filterable: false,\n        Cell: this.renderEditable\n      }, {\n        Header: \"Image\",\n        accessor: \"image\",\n        sortable: false,\n        filterable: false,\n        width: 78,\n        Cell: function Cell(_ref2) {\n          var value = _ref2.value;\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 185\n            },\n            __self: this\n          }, React.createElement(\"img\", {\n            alt: \"\",\n            src: value,\n            width: \"60\",\n            height: \"60\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186\n            },\n            __self: this\n          }));\n        }\n      }, {\n        Header: \"Save\",\n        id: \"savebutton\",\n        sortable: false,\n        filterable: false,\n        width: 80,\n        accessor: \"_links.self.href\",\n        Cell: function Cell(_ref3) {\n          var value = _ref3.value,\n              row = _ref3.row;\n          return _this4.props.role === \"ADMIN\" ? React.createElement(MDBBtn, {\n            color: \"primary\",\n            size: \"sm\",\n            onClick: function onClick() {\n              _this4.updateProduct(row, value);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 200\n            },\n            __self: this\n          }, React.createElement(MDBIcon, {\n            icon: \"marker\",\n            size: \"2x\",\n            className: \"white-text\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 207\n            },\n            __self: this\n          })) : React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 210\n            },\n            __self: this\n          });\n        }\n      }, {\n        Header: \"Delete\",\n        id: \"delbutton\",\n        sortable: false,\n        filterable: false,\n        width: 100,\n        accessor: \"_links.self.href\",\n        Cell: function Cell(_ref4) {\n          var value = _ref4.value,\n              row = _ref4.row;\n          return _this4.props.role === \"ADMIN\" ? React.createElement(MDBBtn, {\n            color: \"danger\",\n            size: \"sm\",\n            onClick: function onClick() {\n              _this4.confirmDelete(value);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 222\n            },\n            __self: this\n          }, React.createElement(MDBIcon, {\n            icon: \"trash\",\n            size: \"2x\",\n            className: \"white-text\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 229\n            },\n            __self: this\n          })) : React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 232\n            },\n            __self: this\n          });\n        }\n      }];\n      var NewPlayListlink = this.props.role !== \"ADMIN\" ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      }) : React.createElement(NewPlayList, {\n        className: \"align-middle\",\n        username: this.props.username,\n        addProduct: this.addProduct,\n        fetchProducts: this.fetchProducts,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      });\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, React.createElement(MDBFormInline, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, NewPlayListlink), React.createElement(ReactTable, {\n        data: this.state.products,\n        columns: columns,\n        filterable: true,\n        defaultFilterMethod: this.customFilter,\n        pageSize: 5,\n        noDataText: React.createElement(\"div\", {\n          className: \"spinner-border fast text-info\",\n          role: \"status\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 260\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"sr-only\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 261\n          },\n          __self: this\n        }, \"Loading...\")),\n        defaultSorted: [{\n          id: \"avgrank\",\n          desc: true\n        }],\n        showPaginationBottom: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }), React.createElement(Snackbar, {\n        open: this.state.open,\n        onClose: this.handleClose,\n        autoHideDuration: 1500,\n        message: this.state.message,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return CatalogList;\n}(Component);\n\nexport default CatalogList;","map":{"version":3,"sources":["/Users/antonmadzharov/Downloads/catalog-master/frontEnd/ReactCatalog/src/components/CatalogList.js"],"names":["React","Component","ReactTable","SERVER_URL","confirmAlert","MDBBtn","MDBIcon","MDBFormInline","Snackbar","NewPlayList","CatalogList","props","fetchProducts","setState","products","token","sessionStorage","getItem","fetch","headers","Authorization","then","response","json","responseData","_embedded","catch","err","console","error","customFilter","filter","row","id","pivotId","undefined","String","toLowerCase","includes","value","confirmDelete","link","message","buttons","label","onClick","onDelClick","method","res","open","renderEditable","cellInfo","backgroundColor","e","data","state","index","column","target","innerHTML","__html","handleClose","event","reason","handleChange","name","username","role","duration","product","body","JSON","stringify","columns","Header","accessor","Cell","filterable","width","sortable","updateProduct","NewPlayListlink","addProduct","desc"],"mappings":";;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,UAAP,MAAuB,aAAvB;AACA,OAAO,6BAAP;AACA,SAASC,UAAT,QAA2B,iBAA3B;AACA,SAASC,YAAT,QAA6B,qBAA7B;AACA,OAAO,iDAAP;AAEA,SAASC,MAAT,EAAiBC,OAAjB,EAA0BC,aAA1B,QAA+C,UAA/C;AACA,OAAOC,QAAP,MAAqB,4BAArB;AAEA,OAAOC,WAAP,MAAwB,eAAxB;;IACMC,W;;;;;AACJ,uBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,qFAAMA,KAAN;AADiB,UAiBnBC,aAjBmB;AAAA;AAAA;AAAA;AAAA,6BAiBH;AAAA;AAAA;AAAA;AAAA;AAAA;AACd,oBAAKC,QAAL,CAAc;AACZC,gBAAAA,QAAQ,EAAE;AADE,eAAd;;AAIMC,cAAAA,KALQ,GAKAC,cAAc,CAACC,OAAf,CAAuB,KAAvB,CALA;AAAA;AAAA,qBAMRC,KAAK,CAACf,UAAU,GAAG,cAAd,EAA8B;AACvCgB,gBAAAA,OAAO,EAAE;AAAEC,kBAAAA,aAAa,EAAEL;AAAjB;AAD8B,eAA9B,CAAL,CAGHM,IAHG,CAGE,UAAAC,QAAQ;AAAA,uBAAIA,QAAQ,CAACC,IAAT,EAAJ;AAAA,eAHV,EAIHF,IAJG,CAIE,UAAAG,YAAY,EAAI;AACpB,sBAAKX,QAAL,CAAc;AACZC,kBAAAA,QAAQ,EAAEU,YAAY,CAACC,SAAb,CAAuBX;AADrB,iBAAd;AAGD,eARG,EASHY,KATG,CASG,UAAAC,GAAG;AAAA,uBAAIC,OAAO,CAACC,KAAR,CAAcF,GAAd,CAAJ;AAAA,eATN,CANQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAjBG;;AAAA,UAmCnBG,YAnCmB,GAmCJ,UAACC,MAAD,EAASC,GAAT,EAAiB;AAC9B,UAAMC,EAAE,GAAGF,MAAM,CAACG,OAAP,IAAkBH,MAAM,CAACE,EAApC;;AACA,UAAID,GAAG,CAACC,EAAD,CAAH,KAAY,IAAZ,IAAoB,OAAOD,GAAG,CAACC,EAAD,CAAV,KAAmB,QAA3C,EAAqD;AACnD,eAAOD,GAAG,CAACC,EAAD,CAAH,KAAYE,SAAZ,GACHC,MAAM,CAACJ,GAAG,CAACC,EAAD,CAAH,CAAQI,WAAR,EAAD,CAAN,CAA8BC,QAA9B,CAAuCP,MAAM,CAACQ,KAAP,CAAaF,WAAb,EAAvC,CADG,GAEH,IAFJ;AAGD;AACF,KA1CkB;;AAAA,UA4CnBG,aA5CmB,GA4CH,UAAAC,IAAI,EAAI;AACtBrC,MAAAA,YAAY,CAAC;AACXsC,QAAAA,OAAO,EAAE,yBADE;AAEXC,QAAAA,OAAO,EAAE,CACP;AACEC,UAAAA,KAAK,EAAE,KADT;AAEEC,UAAAA,OAAO,EAAE;AAAA,mBAAM,MAAKC,UAAL,CAAgBL,IAAhB,CAAN;AAAA;AAFX,SADO,EAKP;AACEG,UAAAA,KAAK,EAAE;AADT,SALO;AAFE,OAAD,CAAZ;AAYD,KAzDkB;;AAAA,UA4DnBE,UA5DmB,GA4DN,UAAAL,IAAI,EAAI;AACnB,UAAM1B,KAAK,GAAGC,cAAc,CAACC,OAAf,CAAuB,KAAvB,CAAd;AACAC,MAAAA,KAAK,CAACuB,IAAD,EAAO;AACVM,QAAAA,MAAM,EAAE,QADE;AAEV5B,QAAAA,OAAO,EAAE;AAAEC,UAAAA,aAAa,EAAEL;AAAjB;AAFC,OAAP,CAAL,CAIGM,IAJH,CAIQ,UAAA2B,GAAG,EAAI;AACX,cAAKnC,QAAL,CAAc;AAAEoC,UAAAA,IAAI,EAAE,IAAR;AAAcP,UAAAA,OAAO,EAAE;AAAvB,SAAd;;AACA,cAAK9B,aAAL;AACD,OAPH,EAQGc,KARH,CAQS,UAAAC,GAAG,EAAI;AACZ,cAAKd,QAAL,CAAc;AAAEoC,UAAAA,IAAI,EAAE,IAAR;AAAcP,UAAAA,OAAO,EAAE;AAAvB,SAAd;;AACAd,QAAAA,OAAO,CAACC,KAAR,CAAcF,GAAd;AACD,OAXH;AAYD,KA1EkB;;AAAA,UA4GnBuB,cA5GmB,GA4GF,UAAAC,QAAQ,EAAI;AAC3B,aACE;AACE,QAAA,KAAK,EAAE;AAAEC,UAAAA,eAAe,EAAE;AAAnB,SADT;AAEE,QAAA,eAAe,MAFjB;AAGE,QAAA,8BAA8B,MAHhC;AAIE,QAAA,MAAM,EAAE,gBAAAC,CAAC,EAAI;AACX,cAAMC,IAAI,sBAAO,MAAKC,KAAL,CAAWzC,QAAlB,CAAV;;AACAwC,UAAAA,IAAI,CAACH,QAAQ,CAACK,KAAV,CAAJ,CAAqBL,QAAQ,CAACM,MAAT,CAAgBxB,EAArC,IAA2CoB,CAAC,CAACK,MAAF,CAASC,SAApD;;AACA,gBAAK9C,QAAL,CAAc;AAAEC,YAAAA,QAAQ,EAAEwC;AAAZ,WAAd;AACD,SARH;AASE,QAAA,uBAAuB,EAAE;AACvBM,UAAAA,MAAM,EAAE,MAAKL,KAAL,CAAWzC,QAAX,CAAoBqC,QAAQ,CAACK,KAA7B,EAAoCL,QAAQ,CAACM,MAAT,CAAgBxB,EAApD;AADe,SAT3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AAeD,KA5HkB;;AAAA,UA8HnB4B,WA9HmB,GA8HL,UAACC,KAAD,EAAQC,MAAR,EAAmB;AAC/B,YAAKlD,QAAL,CAAc;AAAEoC,QAAAA,IAAI,EAAE;AAAR,OAAd;AACD,KAhIkB;;AAAA,UAkInBe,YAlImB,GAkIJ,UAAAF,KAAK,EAAI;AACtB,YAAKjD,QAAL,qBAAiBiD,KAAK,CAACJ,MAAN,CAAaO,IAA9B,EAAqCH,KAAK,CAACJ,MAAN,CAAanB,KAAlD;AACD,KApIkB;;AAEjB,UAAKgB,KAAL,GAAa;AACXW,MAAAA,QAAQ,EAAE,MAAKvD,KAAL,CAAWuD,QADV;AAEXC,MAAAA,IAAI,EAAE,MAAKxD,KAAL,CAAWwD,IAFN;AAGXrD,MAAAA,QAAQ,EAAE,EAHC;AAIXmC,MAAAA,IAAI,EAAE,KAJK;AAKXP,MAAAA,OAAO,EAAE,EALE;AAMX0B,MAAAA,QAAQ,EAAE;AANC,KAAb;AAFiB;AAUlB;;;;wCAEmB;AAClB,WAAKxD,aAAL;AACD,K,CAED;;;;AA4DA;+BACWyD,O,EAAS;AAAA;;AAClB,UAAMtD,KAAK,GAAGC,cAAc,CAACC,OAAf,CAAuB,KAAvB,CAAd;AACAC,MAAAA,KAAK,CAACf,UAAU,GAAG,cAAd,EAA8B;AACjC4C,QAAAA,MAAM,EAAE,MADyB;AAEjC5B,QAAAA,OAAO,EAAE;AACP,0BAAgB,kBADT;AAEPC,UAAAA,aAAa,EAAEL;AAFR,SAFwB;AAMjCuD,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeH,OAAf;AAN2B,OAA9B,CAAL,CAQGhD,IARH,CAQQ,UAAA2B,GAAG;AAAA,eAAI,MAAI,CAACpC,aAAL,EAAJ;AAAA,OARX,EASGc,KATH,CASS,UAAAC,GAAG;AAAA,eAAIC,OAAO,CAACC,KAAR,CAAcF,GAAd,CAAJ;AAAA,OATZ;AAUD,K,CAED;;;;kCACc0C,O,EAAS5B,I,EAAM;AAAA;;AAC3B,UAAM1B,KAAK,GAAGC,cAAc,CAACC,OAAf,CAAuB,KAAvB,CAAd;AACAC,MAAAA,KAAK,CAACuB,IAAD,EAAO;AACVM,QAAAA,MAAM,EAAE,KADE;AAEV5B,QAAAA,OAAO,EAAE;AACP,0BAAgB,kBADT;AAEPC,UAAAA,aAAa,EAAEL;AAFR,SAFC;AAMVuD,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeH,OAAf;AANI,OAAP,CAAL,CAQGhD,IARH,CAQQ,UAAA2B,GAAG;AAAA,eAAI,MAAI,CAACnC,QAAL,CAAc;AAAEoC,UAAAA,IAAI,EAAE,IAAR;AAAcP,UAAAA,OAAO,EAAE;AAAvB,SAAd,CAAJ;AAAA,OARX,EASGhB,KATH,CASS,UAAAC,GAAG;AAAA,eACR,MAAI,CAACd,QAAL,CAAc;AAAEoC,UAAAA,IAAI,EAAE,IAAR;AAAcP,UAAAA,OAAO,EAAE;AAAvB,SAAd,CADQ;AAAA,OATZ;AAYD;;;6BA4BQ;AAAA;;AACP,UAAM+B,OAAO,GAAG,CACd;AACEC,QAAAA,MAAM,EAAE,MADV;AAEEC,QAAAA,QAAQ,EAAE,MAFZ;AAGEC,QAAAA,IAAI,EAAE,KAAK1B;AAHb,OADc,EAMd;AACEwB,QAAAA,MAAM,EAAE,OADV;AAEEG,QAAAA,UAAU,EAAE,KAFd;AAGEF,QAAAA,QAAQ,EAAE,OAHZ;AAIEG,QAAAA,KAAK,EAAE,EAJT;AAKEF,QAAAA,IAAI,EAAE,KAAK1B;AALb,OANc,EAad;AACEwB,QAAAA,MAAM,EAAE,aADV;AAEEC,QAAAA,QAAQ,EAAE,aAFZ;AAGEC,QAAAA,IAAI,EAAE,KAAK1B;AAHb,OAbc,EAkBd;AACEwB,QAAAA,MAAM,EAAE,YADV;AAEEC,QAAAA,QAAQ,EAAE,UAFZ;AAGEG,QAAAA,KAAK,EAAE;AAHT,OAlBc,EAuBd;AACEJ,QAAAA,MAAM,EAAE,WADV;AAEEC,QAAAA,QAAQ,EAAE,OAFZ;AAGEE,QAAAA,UAAU,EAAE,KAHd;AAIED,QAAAA,IAAI,EAAE,KAAK1B;AAJb,OAvBc,EA8Bd;AACEwB,QAAAA,MAAM,EAAE,OADV;AAEEC,QAAAA,QAAQ,EAAE,OAFZ;AAGEI,QAAAA,QAAQ,EAAE,KAHZ;AAIEF,QAAAA,UAAU,EAAE,KAJd;AAKEC,QAAAA,KAAK,EAAE,EALT;AAMEF,QAAAA,IAAI,EAAE;AAAA,cAAGrC,KAAH,SAAGA,KAAH;AAAA,iBACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACE;AAAK,YAAA,GAAG,EAAC,EAAT;AAAY,YAAA,GAAG,EAAEA,KAAjB;AAAwB,YAAA,KAAK,EAAC,IAA9B;AAAmC,YAAA,MAAM,EAAC,IAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,CADI;AAAA;AANR,OA9Bc,EA2Cd;AACEmC,QAAAA,MAAM,EAAE,MADV;AAEEzC,QAAAA,EAAE,EAAE,YAFN;AAGE8C,QAAAA,QAAQ,EAAE,KAHZ;AAIEF,QAAAA,UAAU,EAAE,KAJd;AAKEC,QAAAA,KAAK,EAAE,EALT;AAMEH,QAAAA,QAAQ,EAAE,kBANZ;AAOEC,QAAAA,IAAI,EAAE;AAAA,cAAGrC,KAAH,SAAGA,KAAH;AAAA,cAAUP,GAAV,SAAUA,GAAV;AAAA,iBACJ,MAAI,CAACrB,KAAL,CAAWwD,IAAX,KAAoB,OAApB,GACE,oBAAC,MAAD;AACE,YAAA,KAAK,EAAC,SADR;AAEE,YAAA,IAAI,EAAC,IAFP;AAGE,YAAA,OAAO,EAAE,mBAAM;AACb,cAAA,MAAI,CAACa,aAAL,CAAmBhD,GAAnB,EAAwBO,KAAxB;AACD,aALH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAOE,oBAAC,OAAD;AAAS,YAAA,IAAI,EAAC,QAAd;AAAuB,YAAA,IAAI,EAAC,IAA5B;AAAiC,YAAA,SAAS,EAAC,YAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAPF,CADF,GAWE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAZE;AAAA;AAPR,OA3Cc,EAiEd;AACEmC,QAAAA,MAAM,EAAE,QADV;AAEEzC,QAAAA,EAAE,EAAE,WAFN;AAGE8C,QAAAA,QAAQ,EAAE,KAHZ;AAIEF,QAAAA,UAAU,EAAE,KAJd;AAKEC,QAAAA,KAAK,EAAE,GALT;AAMEH,QAAAA,QAAQ,EAAE,kBANZ;AAOEC,QAAAA,IAAI,EAAE;AAAA,cAAGrC,KAAH,SAAGA,KAAH;AAAA,cAAUP,GAAV,SAAUA,GAAV;AAAA,iBACJ,MAAI,CAACrB,KAAL,CAAWwD,IAAX,KAAoB,OAApB,GACE,oBAAC,MAAD;AACE,YAAA,KAAK,EAAC,QADR;AAEE,YAAA,IAAI,EAAC,IAFP;AAGE,YAAA,OAAO,EAAE,mBAAM;AACb,cAAA,MAAI,CAAC3B,aAAL,CAAmBD,KAAnB;AACD,aALH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAOE,oBAAC,OAAD;AAAS,YAAA,IAAI,EAAC,OAAd;AAAsB,YAAA,IAAI,EAAC,IAA3B;AAAgC,YAAA,SAAS,EAAC,YAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAPF,CADF,GAWE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAZE;AAAA;AAPR,OAjEc,CAAhB;AAyFA,UAAM0C,eAAe,GACnB,KAAKtE,KAAL,CAAWwD,IAAX,KAAoB,OAApB,GACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,GAGE,oBAAC,WAAD;AACE,QAAA,SAAS,EAAC,cADZ;AAEE,QAAA,QAAQ,EAAE,KAAKxD,KAAL,CAAWuD,QAFvB;AAGE,QAAA,UAAU,EAAE,KAAKgB,UAHnB;AAIE,QAAA,aAAa,EAAE,KAAKtE,aAJtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJJ;AAYA,aACE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAgBqE,eAAhB,CADF,EAGE,oBAAC,UAAD;AACE,QAAA,IAAI,EAAE,KAAK1B,KAAL,CAAWzC,QADnB;AAEE,QAAA,OAAO,EAAE2D,OAFX;AAGE,QAAA,UAAU,EAAE,IAHd;AAIE,QAAA,mBAAmB,EAAE,KAAK3C,YAJ5B;AAKE,QAAA,QAAQ,EAAE,CALZ;AAME,QAAA,UAAU,EACR;AAAK,UAAA,SAAS,EAAC,+BAAf;AAA+C,UAAA,IAAI,EAAC,QAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,CAPJ;AAWE,QAAA,aAAa,EAAE,CACb;AACEG,UAAAA,EAAE,EAAE,SADN;AAEEkD,UAAAA,IAAI,EAAE;AAFR,SADa,CAXjB;AAiBE,QAAA,oBAAoB,MAjBtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,EAsBE,oBAAC,QAAD;AACE,QAAA,IAAI,EAAE,KAAK5B,KAAL,CAAWN,IADnB;AAEE,QAAA,OAAO,EAAE,KAAKY,WAFhB;AAGE,QAAA,gBAAgB,EAAE,IAHpB;AAIE,QAAA,OAAO,EAAE,KAAKN,KAAL,CAAWb,OAJtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAtBF,CADF;AA+BD;;;;EA5QuBzC,S;;AA+Q1B,eAAeS,WAAf","sourcesContent":["import React, { Component } from \"react\";\nimport ReactTable from \"react-table\";\nimport \"react-table/react-table.css\";\nimport { SERVER_URL } from \"../constants.js\";\nimport { confirmAlert } from \"react-confirm-alert\";\nimport \"react-confirm-alert/src/react-confirm-alert.css\";\n\nimport { MDBBtn, MDBIcon, MDBFormInline } from \"mdbreact\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\n\nimport NewPlayList from \"./NewPlaylist\";\nclass CatalogList extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: this.props.username,\n      role: this.props.role,\n      products: [],\n      open: false,\n      message: \"\",\n      duration: 0\n    };\n  }\n\n  componentDidMount() {\n    this.fetchProducts();\n  }\n\n  // Fetch all products\n  fetchProducts = async () => {\n    this.setState({\n      products: []\n    });\n\n    const token = sessionStorage.getItem(\"jwt\");\n    await fetch(SERVER_URL + \"api/products\", {\n      headers: { Authorization: token }\n    })\n      .then(response => response.json())\n      .then(responseData => {\n        this.setState({\n          products: responseData._embedded.products\n        });\n      })\n      .catch(err => console.error(err));\n  };\n\n  customFilter = (filter, row) => {\n    const id = filter.pivotId || filter.id;\n    if (row[id] !== null && typeof row[id] === \"string\") {\n      return row[id] !== undefined\n        ? String(row[id].toLowerCase()).includes(filter.value.toLowerCase())\n        : true;\n    }\n  };\n\n  confirmDelete = link => {\n    confirmAlert({\n      message: \"Are you sure to delete?\",\n      buttons: [\n        {\n          label: \"Yes\",\n          onClick: () => this.onDelClick(link)\n        },\n        {\n          label: \"No\"\n        }\n      ]\n    });\n  };\n\n  // Delete product\n  onDelClick = link => {\n    const token = sessionStorage.getItem(\"jwt\");\n    fetch(link, {\n      method: \"DELETE\",\n      headers: { Authorization: token }\n    })\n      .then(res => {\n        this.setState({ open: true, message: \"Deleted\" });\n        this.fetchProducts();\n      })\n      .catch(err => {\n        this.setState({ open: true, message: \"Error when deleting\" });\n        console.error(err);\n      });\n  };\n\n  // Add new product from child\n  addProduct(product) {\n    const token = sessionStorage.getItem(\"jwt\");\n    fetch(SERVER_URL + \"api/products\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: token\n      },\n      body: JSON.stringify(product)\n    })\n      .then(res => this.fetchProducts())\n      .catch(err => console.error(err));\n  }\n\n  // Update Product\n  updateProduct(product, link) {\n    const token = sessionStorage.getItem(\"jwt\");\n    fetch(link, {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: token\n      },\n      body: JSON.stringify(product)\n    })\n      .then(res => this.setState({ open: true, message: \"Changes saved\" }))\n      .catch(err =>\n        this.setState({ open: true, message: \"Error when saving\" })\n      );\n  }\n\n  renderEditable = cellInfo => {\n    return (\n      <div\n        style={{ backgroundColor: \"#fafafa\" }}\n        contentEditable\n        suppressContentEditableWarning\n        onBlur={e => {\n          const data = [...this.state.products];\n          data[cellInfo.index][cellInfo.column.id] = e.target.innerHTML;\n          this.setState({ products: data });\n        }}\n        dangerouslySetInnerHTML={{\n          __html: this.state.products[cellInfo.index][cellInfo.column.id]\n        }}\n      />\n    );\n  };\n\n  handleClose = (event, reason) => {\n    this.setState({ open: false });\n  };\n\n  handleChange = event => {\n    this.setState({ [event.target.name]: event.target.value });\n  };\n\n  render() {\n    const columns = [\n      {\n        Header: \"Name\",\n        accessor: \"name\",\n        Cell: this.renderEditable\n      },\n      {\n        Header: \"Price\",\n        filterable: false,\n        accessor: \"price\",\n        width: 78,\n        Cell: this.renderEditable\n      },\n      {\n        Header: \"Description\",\n        accessor: \"description\",\n        Cell: this.renderEditable\n      },\n      {\n        Header: \"Created by\",\n        accessor: \"username\",\n        width: 110\n      },\n      {\n        Header: \"Image URL\",\n        accessor: \"image\",\n        filterable: false,\n        Cell: this.renderEditable\n      },\n\n      {\n        Header: \"Image\",\n        accessor: \"image\",\n        sortable: false,\n        filterable: false,\n        width: 78,\n        Cell: ({ value }) => (\n          <div>\n            <img alt=\"\" src={value} width=\"60\" height=\"60\" />\n          </div>\n        )\n      },\n\n      {\n        Header: \"Save\",\n        id: \"savebutton\",\n        sortable: false,\n        filterable: false,\n        width: 80,\n        accessor: \"_links.self.href\",\n        Cell: ({ value, row }) =>\n          this.props.role === \"ADMIN\" ? (\n            <MDBBtn\n              color=\"primary\"\n              size=\"sm\"\n              onClick={() => {\n                this.updateProduct(row, value);\n              }}\n            >\n              <MDBIcon icon=\"marker\" size=\"2x\" className=\"white-text\" />\n            </MDBBtn>\n          ) : (\n            <div />\n          )\n      },\n      {\n        Header: \"Delete\",\n        id: \"delbutton\",\n        sortable: false,\n        filterable: false,\n        width: 100,\n        accessor: \"_links.self.href\",\n        Cell: ({ value, row }) =>\n          this.props.role === \"ADMIN\" ? (\n            <MDBBtn\n              color=\"danger\"\n              size=\"sm\"\n              onClick={() => {\n                this.confirmDelete(value);\n              }}\n            >\n              <MDBIcon icon=\"trash\" size=\"2x\" className=\"white-text\" />\n            </MDBBtn>\n          ) : (\n            <div />\n          )\n      }\n    ];\n\n    const NewPlayListlink =\n      this.props.role !== \"ADMIN\" ? (\n        <div />\n      ) : (\n        <NewPlayList\n          className=\"align-middle\"\n          username={this.props.username}\n          addProduct={this.addProduct}\n          fetchProducts={this.fetchProducts}\n        />\n      );\n\n    return (\n      <div className=\"App\">\n        <MDBFormInline>{NewPlayListlink}</MDBFormInline>\n\n        <ReactTable\n          data={this.state.products}\n          columns={columns}\n          filterable={true}\n          defaultFilterMethod={this.customFilter}\n          pageSize={5}\n          noDataText={\n            <div className=\"spinner-border fast text-info\" role=\"status\">\n              <span className=\"sr-only\">Loading...</span>\n            </div>\n          }\n          defaultSorted={[\n            {\n              id: \"avgrank\",\n              desc: true\n            }\n          ]}\n          showPaginationBottom\n        />\n        <Snackbar\n          open={this.state.open}\n          onClose={this.handleClose}\n          autoHideDuration={1500}\n          message={this.state.message}\n        />\n      </div>\n    );\n  }\n}\n\nexport default CatalogList;\n"]},"metadata":{},"sourceType":"module"}